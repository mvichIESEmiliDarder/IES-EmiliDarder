

## Instalación de Nginx

Para instalar **Nginx** en Ubuntu, primero actualiza la lista de paquetes y luego instala el servidor web:

```bash
sudo apt update
sudo apt install nginx
```

### 📋 Verificación y Control del Servicio

Una vez instalado, el servicio de Nginx debería iniciarse automáticamente.

| Comando | Propósito |
| :--- | :--- |
| `sudo systemctl status nginx` | Verifica si Nginx está corriendo. |
| `sudo systemctl enable nginx` | Asegura que Nginx se inicie al arrancar el sistema. |
| `sudo ufw allow 'Nginx Full'` | Abre el firewall (UFW) para el tráfico HTTP (puerto 80) y HTTPS (puerto 443). |

-----

## Configuración de Bloques de Servidor (Server Blocks)

Los **Server Blocks** en Nginx son el equivalente funcional a los **Virtual Hosts** de Apache. Permiten hospedar múltiples sitios web (dominios) en un solo servidor.

### 1\. La Lógica de Configuración: Archivos y Directorios

Nginx organiza sus configuraciones de la siguiente manera:

  - **Configuración Principal:** El archivo principal es `/etc/nginx/nginx.conf`.

  - **Configuraciones de Bloques de Servidor:** Se organizan en directorios similares a Apache:

      - `/etc/nginx/sites-available`: Contiene archivos de configuración de sitios que **pueden** usarse (plantillas).

      - `/etc/nginx/sites-enabled`: Contiene **enlaces simbólicos** a los archivos de `sites-available` para los sitios que **están** activos.

| **Directorio** | **Propósito** |
| :--- | :--- |
| `/etc/nginx/sites-available` | Plantillas y configuraciones listas para activar. |
| `/etc/nginx/sites-enabled` | Sitios web actualmente **activos** (enlaces simbólicos). |

-----

### 2\. Creación y Configuración del Nuevo Sitio

El objetivo es servir diferentes **dominios** desde el mismo servidor.

1.  **Crear el Directorio Raíz para tu Sitio:** Es una buena práctica crear un directorio dedicado para los archivos de tu sitio web.

    ```bash
    sudo mkdir -p /var/www/tu_sitio_web/html
    ```

2.  **Asignar Permisos:** Asegúrate de que los permisos sean correctos, especialmente para el usuario `www-data` que es el que usa Nginx.

    ```bash
    sudo chown -R $USER:$USER /var/www/tu_sitio_web
    sudo chmod -R 755 /var/www/tu_sitio_web
    ```

3.  **Crear el Archivo de Configuración:** Copia la plantilla predeterminada o crea un nuevo archivo.

    ```bash
    cd /etc/nginx/sites-available
    sudo cp default tu_sitio_web.conf
    ```

4.  **Configurar el Archivo `tu_sitio_web.conf`:** Edita este archivo (p. ej., con `sudo nano tu_sitio_web.conf`) para definir tu *Server Block*. Las directivas clave son:

      - **`server_name`:** El **dominio/URL** con el que se accederá al sitio (ej. `www.tu_sitio.com`). ¡**Esto es crucial** para distinguir los Server Blocks\!

      - **`root`:** El **directorio raíz** donde se encuentran los archivos de tu sitio web (el equivalente a `DocumentRoot` en Apache).

#### Plantilla Básica de Server Block:

```nginx
server {
    listen 80; # Escucha el puerto estándar HTTP
    listen [::]:80; # IPv6

    # ¡CLAVE! El nombre de dominio al que responderá este bloque
    server_name tu_sitio.com www.tu_sitio.com; 

    # ¡CLAVE! La ruta al directorio raíz de los archivos
    root /var/www/tu_sitio_web/html;

    index index.html index.htm index.nginx-debian.html;

    location / {
        try_files $uri $uri/ =404;
    }

    # ... Otras configuraciones (logs, SSL, etc.)
}
```

-----

### 3\. Activación y Recarga

Una vez configurado el archivo `.conf`, sigue estos pasos para activarlo:

1.  **Crear el Enlace Simbólico (Habilitar el Sitio):** Crea un enlace del archivo en `sites-available` al directorio `sites-enabled`.

    ```bash
    sudo ln -s /etc/nginx/sites-available/tu_sitio_web.conf /etc/nginx/sites-enabled/
    ```

    > 💡 **Nota:** Nginx no tiene un comando dedicado como `a2ensite`, se usa `ln -s` directamente.

2.  **Verificar la Sintaxis:** Antes de aplicar los cambios, verifica si la configuración no tiene errores.

    ```bash
    sudo nginx -t
    ```

    *(Debe responder: `syntax is ok` y `test is successful`)*

3.  **Recargar Nginx:** Aplica los cambios sin interrumpir el servicio.

    ```bash
    sudo systemctl reload nginx
    ```

    *Para un cambio mayor o si la recarga falla, usa `restart`: `sudo systemctl restart nginx`.*

-----

### ⚠️ Aclaraciones sobre las Directivas

  - La directiva **`root`** es la clave para indicar dónde están los archivos del sitio.

  - **`server_name`** es la clave para el *Server Block*, indicando qué URL debe responder con esta configuración.

  - La directiva **`listen 80;`** define el puerto.

  - El bloque **`location / { ... }`** define cómo Nginx maneja las peticiones para la ruta base (`/`).