## ‚öôÔ∏è Gu√≠a Paso a Paso para el Entorno de Desarrollo

El objetivo es permitir que tu usuario normal pueda escribir en el directorio web (`/var/www/html`) sin usar `sudo` para cada operaci√≥n.

### Paso 1: A√±adir tu Usuario al Grupo de Apache (`www-data`)

El servidor web Apache se ejecuta bajo el usuario y grupo `www-data`. Al unirte a este grupo, obtienes los permisos que se le asignen al grupo en la carpeta web.

1. Abre tu terminal y ejecuta el comando, reemplazando `tu_usuario` con tu nombre de usuario de Ubuntu:
    
    Bash
    
    ```
    sudo usermod -a -G www-data tu_usuario
    ```
    
2. **Aplica los cambios:** Para que los nuevos permisos de grupo surtan efecto, debes **cerrar la sesi√≥n** de tu terminal (o de tu entorno de escritorio) y **volver a iniciarla**.
    

---

### Paso 2: Configurar la Pertenencia al Grupo de la Carpeta Web

Estableceremos que el grupo propietario de la carpeta web sea `www-data`.

1. Abre tu terminal y ejecuta el comando:
    
    Bash
    
    ```
    sudo chgrp -R www-data /var/www/html
    ```
    
    - `chgrp`: Cambia la pertenencia al grupo.
        
    - `-R`: Hace el cambio de forma **recursiva** (afecta a todos los archivos y subdirectorios).
        

---

### Paso 3: Otorgar Permisos de Escritura al Grupo

Damos permisos de **escritura** al grupo (`www-data`) sobre la carpeta y sus contenidos.

1. Ejecuta el siguiente comando para otorgar permisos **775**:
    
    Bash
    
    ```
    sudo chmod -R 775 /var/www/html
    ```
    
    - **7 (due√±o)**: Lectura, Escritura, Ejecuci√≥n (para el usuario `root` o el que sea due√±o).
        
    - **7 (grupo)**: Lectura, Escritura, Ejecuci√≥n (para el grupo `www-data`, incluy√©ndote a ti).
        
    - **5 (otros)**: Lectura y Ejecuci√≥n.
        
2. **Configurar herencia de grupo (Sticky Bit):** Este comando asegura que cualquier archivo o carpeta nueva que se cree dentro de `/var/www/html` herede autom√°ticamente el grupo `www-data`.
    
    Bash
    
    ```
    sudo chmod g+s /var/www/html
    ```
    
    A partir de ahora, podr√°s usar comandos normales (como `cp`, `mv`) o tu cliente SFTP/SCP con tu usuario normal para trabajar en la carpeta.
    

---

## üîí Consideraciones de Seguridad y Buenas Pr√°cticas

La configuraci√≥n anterior te da comodidad para desarrollar, pero introduce un **riesgo de seguridad**.

### Riesgo: Escalada de Privilegios por `www-data`

|**Riesgo**|**Explicaci√≥n**|
|---|---|
|**Escritura del proceso web**|Dado que el servidor web Apache se ejecuta como `www-data`, si tu c√≥digo es comprometido (por un _exploit_ o _script_ malicioso), el atacante puede usar los permisos del usuario `www-data` para **escribir y modificar cualquier archivo** en el directorio web. Esto permite que el atacante persista inyectando _backdoors_ o _webshells_.|

### üõ°Ô∏è Mitigaci√≥n del Riesgo en Entornos de Desarrollo

En un entorno de desarrollo, se asume un riesgo mayor por la comodidad. Las principales mitigaciones son:

1. **Aislamiento:** Aseg√∫rate de que tu entorno de desarrollo no sea accesible desde internet (usa un **firewall** como UFW) y solo expon el puerto SSH si es remoto.
    
2. **Copias de Seguridad:** Mant√©n copias de tus archivos originales, ya que un fallo en el c√≥digo podr√≠a corromper todo el directorio.
    

### üè≠ Buenas Pr√°cticas y Seguridad en Producci√≥n

**En un servidor de producci√≥n (en vivo), la configuraci√≥n debe ser mucho m√°s estricta para minimizar la superficie de ataque.**

|**Pr√°ctica**|**Detalle**|**Comando Ejemplo**|
|---|---|---|
|**Principio del Menor Privilegio**|El servidor web (`www-data`) **solo debe tener permisos de escritura** en las carpetas que lo necesiten _expl√≠citamente_ (ej. `uploads`, `cache`, `logs`). **Nunca** debe tener escritura en el c√≥digo de la aplicaci√≥n (los `.php` o `.html`).|`sudo chmod -R 755 /var/www/html` (para carpetas) `sudo chmod -R 644 /var/www/html/*.php` (para archivos)|
|**Separar Permisos de Carga**|La persona que sube los archivos (el desarrollador, t√∫) debe ser el **due√±o** del archivo. El servidor web (`www-data`) solo necesita ser el **grupo** para leerlo.|`sudo chown -R tu_usuario:www-data /var/www/html`|
|**Usar SFTP/SCP**|Siempre utiliza protocolos seguros para la transferencia de archivos, ya que cifran tu contrase√±a. El FTP tradicional no debe usarse nunca.|(Usas tu cliente SFTP favorito: FileZilla, Cyberduck, o el comando `scp`).|
|**Carpetas Temporales**|Si una aplicaci√≥n necesita crear o modificar archivos temporalmente, se deben crear subdirectorios espec√≠ficos dentro del directorio del proyecto (ej. `/var/www/html/cache`) y solo a estas carpetas se les debe dar el permiso **775** al grupo `www-data`.|`sudo chmod -R 775 /var/www/html/cache`|

**En resumen para producci√≥n:** El c√≥digo base debe ser de **solo lectura** para Apache. Si el c√≥digo necesita escribir algo, debe ser en un directorio espec√≠fico de **datos** o **carga** bien delimitado.