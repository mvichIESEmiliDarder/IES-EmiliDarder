# Directivas en Apache HTTP Server: Guía de Configuración

Las **directivas** en Apache HTTP Server son **instrucciones de configuración** que le indican al servidor web cómo debe comportarse. Son la base para personalizar y gestionar prácticamente todos los aspectos del servidor, desde qué archivos servir hasta cómo manejar la seguridad y el rendimiento.

-----

## 1\. Definición y Estructura Básica

Una directiva es esencialmente una **línea de comando** que especifica una acción o establece un valor para un parámetro de configuración.

### Estructura de una Directiva

Generalmente, una directiva se compone de un nombre de comando y sus argumentos:

`Directiva Arg1, Arg2`

  - **Directiva**: El nombre del comando (ej. `Listen`, `DocumentRoot`, `Options`).
  - **Argumentos**: Valores o parámetros necesarios para que la directiva funcione (ej. un puerto, una ruta de archivo, un estado).

**Ejemplo:**

```apache
Listen 80
DocumentRoot "/var/www/html"
```

-----

## 2\. Contexto y Ubicación de las Directivas

Una característica clave de la configuración de Apache es el **contexto** de una directiva, que define dónde puede ser utilizada, y por lo tanto, dónde se encuentran en el sistema de archivos.

### Contextos de Uso (Ámbito)

El contexto determina el **alcance** de la directiva:

| Contexto (Abreviatura) | Dónde se aplica | Descripción |
| :--- | :--- | :--- |
| **Server config (s)** | Archivos de configuración principales | Aplica a la operación general del servidor. |
| **Virtual host (v)** | Dentro de `<VirtualHost>` | Aplica a un sitio web o dominio específico. |
| **Directory (d)** | Dentro de `<Directory>` o `<Location>` | Aplica a un directorio o una URL específica. |
| **`.htaccess` (a)** | Archivos de configuración distribuidos | Permite configuraciones por directorio sin modificar los archivos principales. |

Si una directiva se usa fuera de su contexto permitido, el servidor generará un error de configuración al iniciar o recargar.

### Ubicación Física

Estas directivas se encuentran principalmente en los **archivos de configuración** de Apache:

1.  **`httpd.conf`** (o `apache2.conf`): El archivo de configuración principal, que contiene las directivas globales.
2.  **Archivos incluidos**: Archivos específicos para configuraciones modulares o de *Virtual Hosts* (ej. en directorios como `sites-available/`, `mods-available/`, `conf-available/`).
3.  **`.htaccess`**: Archivos de configuración **distribuidos** que permiten a los usuarios (sin acceso a la configuración principal) anular ciertas configuraciones a nivel de directorio, si está permitido por la configuración principal.

-----

## 3\. Tipos de Directivas Comunes

Las directivas se pueden clasificar según su función y el aspecto del servidor que controlan:

### A. Directivas de Entorno Global

Controlan la operación general del servidor (*contexto **Server config***):

  - **`Listen`**: Especifica la dirección IP y el puerto donde el servidor debe escuchar las peticiones (ej. `Listen 80`).
  - **`ServerName`**: Define el nombre de host y el puerto que el servidor usa para identificarse (ej. `ServerName www.ejemplo.com`).
  - **`User`** y **`Group`**: Definen el usuario y grupo bajo el cual el servidor ejecuta los procesos hijo para servir contenido.

### B. Directivas de Módulos

Apache es modular, y muchas funcionalidades se añaden a través de ellos (ej. para reescritura de URLs o seguridad):

  - **`LoadModule`**: Carga un módulo específico en el servidor (ej. `LoadModule rewrite_module modules/mod_rewrite.so`).
  - **Directivas específicas del módulo**: Directivas que solo están disponibles una vez que su módulo asociado ha sido cargado (ej. `RewriteEngine On` y `RewriteRule` del módulo `mod_rewrite`).

### C. Directivas de Contenedores (*Containers*)

Son directivas que **agrupan otras directivas** y las aplican solo a un ámbito específico, definiendo el **contexto** de lo que contienen. Se definen entre etiquetas de apertura y cierre `<Directiva> ... </Directiva>`.

| Contenedor | Contexto que define | Función |
| :--- | :--- | :--- |
| **`<VirtualHost>`** | *Virtual host* | Define la configuración para un sitio web o dominio específico. |
| **`<Directory>`** | *Directory* | Aplica configuraciones a un directorio del sistema de archivos. |
| **`<Location>`** | *Directory* | Aplica configuraciones a una URL específica (ruta web). |
| **`<Files>`** | *Directory* | Aplica configuraciones a archivos específicos por nombre. |

**Ejemplo de contenedor:**

```apache
<VirtualHost *:80>
    ServerName mi-dominio.com
    DocumentRoot /var/www/mi-dominio
</VirtualHost>
```

### D. Directivas de Seguridad y Control de Acceso

Controlan quién y cómo puede acceder al contenido (*contextos **Directory** o **Virtual host***):

  - **`Require`**: Controla quién puede acceder a un recurso (ej. `Require all granted` o `Require ip 192.168.1.0/24`).
  - **`Options`**: Habilita o deshabilita características específicas de un directorio (ej. ejecutar CGI, seguir enlaces simbólicos, mostrar índices de directorio).