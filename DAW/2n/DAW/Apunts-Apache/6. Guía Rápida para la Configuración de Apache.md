## Instalaci贸n de Apache

Para instalar el servidor web **Apache2** en Ubuntu, primero actualiza la lista de paquetes y luego instala el servidor:

```bash
sudo apt update
sudo apt install apache2
```

-----

###  Verificaci贸n y Control del Servicio

Una vez instalado, el servicio de Apache2 (el paquete es `apache2`) deber铆a iniciarse autom谩ticamente.

| Comando | Prop贸sito |
| :--- | :--- |
| `sudo systemctl status apache2` | Verifica si Apache est谩 corriendo y su estado actual. |
| `sudo systemctl enable apache2` | Asegura que Apache se inicie autom谩ticamente al arrancar el sistema. (Generalmente se habilita por defecto con la instalaci贸n). |
| `sudo ufw allow 'Apache Full'` | Abre el firewall (UFW) para el tr谩fico **HTTP** (puerto 80) y **HTTPS** (puerto 443). |

#### Otros Comandos tiles

| Comando | Prop贸sito |
| :--- | :--- |
| `sudo systemctl start apache2` | Inicia el servicio de Apache2. |
| `sudo systemctl stop apache2` | Detiene el servicio de Apache2. |
| `sudo systemctl restart apache2` | Detiene y luego inicia el servicio (煤til despu茅s de cambios mayores en la configuraci贸n). |
| `sudo systemctl reload apache2` | Recarga la configuraci贸n sin interrumpir las conexiones actuales (煤til despu茅s de cambios menores). |

-----

###  Perfiles de UFW para Apache

Apache registra varios perfiles con UFW que puedes usar para controlar el acceso:

  * **`Apache`**: Abre solo el puerto **80** (HTTP, tr谩fico no cifrado).
  * **`Apache Secure`**: Abre solo el puerto **443** (HTTPS, tr谩fico cifrado).
  * **`Apache Full`**: Abre **ambos** puertos 80 y 443. (El equivalente al `Nginx Full` que mencionaste).

Puedes ver los perfiles disponibles con `sudo ufw app list`.

---

Resumen de los pasos y la l贸gica para configurar **Virtual Hosts** (servidores virtuales) en Apache2.

### 1. La L贸gica de Configuraci贸n: Archivos y Directorios

Apache se gestiona principalmente a trav茅s de dos tipos de archivos de configuraci贸n:

- **Configuraci贸n General:** El archivo principal, usualmente en `/etc/apache2/apache2.conf` (en lugar de `apache.conf`), contiene directivas globales que afectan a todo el servidor.
    
- **Configuraciones de Sitios (Virtual Hosts):** Se organizan en dos directorios:
    
    - `/etc/apache2/sites-available`: Contiene archivos de configuraci贸n de sitios que **pueden** usarse.
        
    - `/etc/apache2/sites-enabled`: Contiene **enlaces simb贸licos** a los archivos de `sites-available` para los sitios que **est谩n** activos.
        

|**Directorio**|**Prop贸sito**|
|---|---|
|`/etc/apache2/sites-available`|Plantillas y configuraciones listas para activar.|
|`/etc/apache2/sites-enabled`|Sitios web actualmente **activos** (enlaces simb贸licos).|

---

### 2. Creaci贸n y Configuraci贸n del Nuevo Sitio

El objetivo de los _Virtual Hosts_ es servir m煤ltiples **dominios** (URLs) desde el mismo servidor (ej. `www.tienda-bici.es` y `www.hostal-cama.com`).

1. **Copiar la Plantilla:** Usa la plantilla de configuraci贸n predeterminada para tu nuevo sitio.
    
    Bash
    
    ```
    cd /etc/apache2/sites-available
    sudo cp 000-default.conf tu_sitio.conf
    ```
    
2. **Configurar el Archivo `tu_sitio.conf`:** Edita este nuevo archivo. Las directivas clave que **debes** configurar dentro del bloque `<VirtualHost>` son:
    
    - **`ServerName`:** La **URL/dominio** con el que se acceder谩 al sitio (ej. `www.tu_sitio.com`). **隆Esto es crucial!**
        
    - **`DocumentRoot`:** El **directorio ra铆z** donde se encuentran los archivos de tu sitio web (ej. `/var/www/tu_sitio`).
        
    - **`ServerAlias` (Opcional):** Nombres de dominio adicionales para el mismo sitio (ej. `tu_sitio.com`).
        

---

### 3. Activaci贸n y Recarga

Una vez configurado el archivo `.conf`, sigue estos pasos para activarlo:

1. **Habilitar el Sitio:** Usa el comando `a2ensite` para crear el enlace simb贸lico y activar el sitio.
    
    Bash
    
    ```
    sudo a2ensite tu_sitio.conf
    ```
    
2. **Verificar la Sintaxis:** Antes de recargar, aseg煤rate de que la configuraci贸n no tiene errores de sintaxis.
    
    Bash
    
    ```
    sudo apachectl configtest
    ```
    
    _(Debe responder: `Syntax OK`)_
    
3. **Recargar Apache:** Aplica los cambios sin interrumpir el servicio.
    
    Bash
    
    ```
    sudo systemctl reload apache2
    ```
    
    _Para un cambio mayor o si la recarga falla, usa `restart`._
    

---

### 锔 Aclaraciones sobre las Directivas

- La directiva **`DocumentRoot`** es la clave para indicar d贸nde est谩n los archivos del sitio.
    
- **`ServerName`** es la clave para el _Virtual Host_, diciendo qu茅 URL debe responder con esta configuraci贸n.
    
- **IP y Puerto** (ej. `<VirtualHost *:80>`) casi siempre se dejan en `*:80` (todas las IP en el puerto est谩ndar HTTP).
    
- La directiva **`port`** no se usa dentro de los archivos de _sites-available_; el puerto se define en el bloque `<VirtualHost *:80>` y se escucha globalmente en otro archivo (`ports.conf`).