# ‚öôÔ∏è Gu√≠a Paso a Paso para el Entorno de Desarrollo (NGINX)

El objetivo es permitir que tu usuario normal pueda escribir en el directorio web (`/var/www/html`) sin usar `sudo` para cada operaci√≥n, manteniendo la compatibilidad con el servidor web **NGINX**.

### Paso 1: A√±adir tu Usuario al Grupo de NGINX (`www-data` o `nginx`)

El servidor web NGINX se ejecuta com√∫nmente bajo el usuario y grupo **`www-data`** (en Debian/Ubuntu) o **`nginx`** (en RHEL/CentOS). Al unirte a este grupo, obtienes los permisos de acceso a la carpeta web.

1.  Abre tu terminal y ejecuta el comando (usando `www-data` o el grupo de tu sistema, reemplazando `tu_usuario`):

    Bash

    ```bash
    sudo usermod -a -G www-data tu_usuario
    # O bien:
    # sudo usermod -a -G nginx tu_usuario
    ```

2.  **Aplica los cambios:** Para que los nuevos permisos de grupo surtan efecto, debes **cerrar la sesi√≥n** de tu terminal (o de tu entorno de escritorio) y **volver a iniciarla**.

-----

### Paso 2: Configurar la Pertenencia al Grupo de la Carpeta Web

Estableceremos que el grupo propietario de la carpeta web sea el grupo de ejecuci√≥n de NGINX.

1.  Abre tu terminal y ejecuta el comando (usando el grupo que corresponda):

    Bash

    ```bash
    sudo chgrp -R www-data /var/www/html
    ```

      - `chgrp`: Cambia la pertenencia al grupo.
      - `-R`: Hace el cambio de forma **recursiva** (afecta a todos los archivos y subdirectorios).

-----

### Paso 3: Otorgar Permisos de Escritura al Grupo

Damos permisos de **escritura** al grupo (`www-data` o `nginx`) sobre la carpeta y sus contenidos.

1.  Ejecuta el siguiente comando para otorgar permisos **775**:

    Bash

    ```bash
    sudo chmod -R 775 /var/www/html
    ```

      - **7 (due√±o)**: Lectura, Escritura, Ejecuci√≥n.
      - **7 (grupo)**: Lectura, Escritura, Ejecuci√≥n (para el grupo de NGINX, incluy√©ndote a ti).
      - **5 (otros)**: Lectura y Ejecuci√≥n.

2.  **Configurar herencia de grupo (Sticky Bit):** Este comando asegura que cualquier archivo o carpeta nueva que se cree dentro de `/var/www/html` herede autom√°ticamente el grupo de NGINX.

    Bash

    ```bash
    sudo chmod g+s /var/www/html
    ```

    A partir de ahora, podr√°s usar comandos normales o tu cliente SFTP/SCP con tu usuario normal para trabajar en la carpeta.

-----

## üîí Consideraciones de Seguridad y Buenas Pr√°cticas

La configuraci√≥n anterior te da comodidad para desarrollar, pero introduce un **riesgo de seguridad**.

### Riesgo: Escalada de Privilegios por el Proceso de NGINX

|**Riesgo**|**Explicaci√≥n**|
|---|---|
|**Escritura del proceso web**|Dado que el servidor web NGINX se ejecuta como `www-data` (o `nginx`), si tu c√≥digo es comprometido (por un *exploit* o *script* malicioso), el atacante puede usar los permisos de ese usuario para **escribir y modificar cualquier archivo** en el directorio web. Esto permite que el atacante persista inyectando *backdoors* o *webshells*.|

### üõ°Ô∏è Mitigaci√≥n del Riesgo en Entornos de Desarrollo

En un entorno de desarrollo, las principales mitigaciones son:

1.  **Aislamiento:** Aseg√∫rate de que tu entorno no sea accesible desde internet (usa un **firewall** como UFW) y restringe el acceso externo a los puertos (80/443).
2.  **Copias de Seguridad:** Mant√©n copias de tus archivos originales.

### üè≠ Buenas Pr√°cticas y Seguridad en Producci√≥n

**En un servidor de producci√≥n (en vivo), la configuraci√≥n debe ser mucho m√°s estricta para minimizar la superficie de ataque.**

|**Pr√°ctica**|**Detalle**|**Comando Ejemplo**|
|---|---|---|
|**Principio del Menor Privilegio**|El servidor web (el usuario `www-data` o `nginx`) **solo debe tener permisos de lectura** sobre el c√≥digo de la aplicaci√≥n (los `.php` o `.html`). **Nunca** debe tener escritura en el c√≥digo fuente.|`sudo chmod -R 755 /var/www/html` (para carpetas) `sudo chmod -R 644 /var/www/html/*.php` (para archivos)|
|**Separar Permisos de Carga**|El desarrollador (t√∫) debe ser el **due√±o** del archivo. El servidor web solo necesita ser el **grupo** para leerlo.|`sudo chown -R tu_usuario:www-data /var/www/html`|
|**Usar SFTP/SCP**|Siempre utiliza protocolos seguros para la transferencia de archivos, ya que cifran tu contrase√±a. El FTP tradicional no debe usarse nunca.|(Usas tu cliente SFTP favorito, o el comando `scp`).|
|**Carpetas Temporales**|Si una aplicaci√≥n necesita crear o modificar archivos temporalmente, se deben crear subdirectorios espec√≠ficos (ej. `/var/www/html/cache`) y solo a estas carpetas se les debe dar el permiso **775** al grupo de NGINX.|`sudo chmod -R 775 /var/www/html/cache`|

**En resumen para producci√≥n:** El c√≥digo base debe ser de **solo lectura** para NGINX. Si el c√≥digo necesita escribir algo, debe ser en un directorio espec√≠fico de **datos** o **carga** bien delimitado.