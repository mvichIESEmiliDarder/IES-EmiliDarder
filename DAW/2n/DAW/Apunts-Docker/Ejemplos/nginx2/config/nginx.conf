# user nobody; # Usado a veces en Alpine, pero 'nginx' por defecto funciona bien
worker_processes auto; # NGINX ajustará el número de procesos a la CPU del contenedor

# Error log path (donde NGINX escribe los errores)
error_log /var/log/nginx/error.log warn;
# Process ID file path
pid /var/run/nginx.pid;

events {
    # Máximo número de conexiones simultáneas que un worker_process puede manejar
    worker_connections 1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    # Log format (opcional, para definir cómo se registran las peticiones)
    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main; # Donde NGINX escribe el log de acceso

    sendfile        on; # Optimiza la transferencia de archivos estáticos
    keepalive_timeout  65; # Mantiene la conexión abierta

    # Definición del Servidor (Virtual Host)
    server {
        listen 80; # Puerto que NGINX escucha dentro del contenedor

        # server_name localhost; # Puede ser omitido en Docker simple

        # Definición de la Ubicación
        location / {
            # root: La dependencia de código (donde se copian los archivos HTML/CSS/JS)
            # Esta es la ruta por defecto para NGINX en muchos Dockerfiles.
            root   /var/www/html;
            
            # index: El nombre del archivo que NGINX debe buscar por defecto
            index  index.html index.htm;
        }

        # Error handling (opcional, para mostrar una página 50x personalizada)
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   /usr/share/nginx/html;
        }
    }
    
    # IMPORTANTE para Docker:
    # Usamos la bandera '-g daemon off;' en el CMD, pero esta configuración
    # asegura que no haya otros archivos de configuración cargando y complicando el inicio.
}